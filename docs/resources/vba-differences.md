---
title: スクリプトと VBA Officeの違い
description: スクリプトと VBA マクロの動作Office API Excel違い。
ms.date: 05/18/2021
localization_priority: Normal
ms.openlocfilehash: 612a5f21d935fd262a6e9fd12a3431956105636a
ms.sourcegitcommit: 4687693f02fc90a57ba30c461f35046e02e6f5fb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/19/2021
ms.locfileid: "52545589"
---
# <a name="differences-between-office-scripts-and-vba-macros"></a><span data-ttu-id="b6513-103">スクリプトと VBA Officeの違い</span><span class="sxs-lookup"><span data-stu-id="b6513-103">Differences between Office Scripts and VBA macros</span></span>

<span data-ttu-id="b6513-104">Officeスクリプトと VBA マクロには多くの共通点があります。</span><span class="sxs-lookup"><span data-stu-id="b6513-104">Office Scripts and VBA macros have a lot in common.</span></span> <span data-ttu-id="b6513-105">どちらも、ユーザーが使いやすいアクション レコーダーを使用してソリューションを自動化し、それらの記録の編集を許可します。</span><span class="sxs-lookup"><span data-stu-id="b6513-105">They both allow users to automate solutions through an easy-to-use action recorder and allow edits of those recordings.</span></span> <span data-ttu-id="b6513-106">どちらのフレームワークも、プログラマが自分を考慮しない可能性があるユーザーに、小規模なプログラムを作成する権限を与Excel。</span><span class="sxs-lookup"><span data-stu-id="b6513-106">Both frameworks are designed to empower people who may not consider themselves programmers to create small programs in Excel.</span></span>
<span data-ttu-id="b6513-107">基本的な違いは、VBA マクロがデスクトップ ソリューション用に開発され、スクリプトOfficeクラウドベースのソリューション用に設計されている点です。</span><span class="sxs-lookup"><span data-stu-id="b6513-107">The fundamental difference is that VBA macros are developed for desktop solutions and Office Scripts are designed for secure, cloud-based solutions.</span></span> <span data-ttu-id="b6513-108">現在、Officeスクリプトは、このスクリプトでのみExcel on the web。</span><span class="sxs-lookup"><span data-stu-id="b6513-108">Currently, Office Scripts are only supported in Excel on the web.</span></span>

:::image type="content" source="../images/office-programmability-diagram.png" alt-text="さまざまな拡張ソリューションのフォーカス領域を示す 4 象限Office図。Office スクリプトと VBA マクロの両方は、エンド ユーザーがソリューションを作成するのに役立つ設計ですが、Office スクリプトは Web とコラボレーション用に構築されています (VBA はデスクトップ用です)。":::

<span data-ttu-id="b6513-110">この記事では、VBA マクロ (および VBA 全般) とスクリプトの主な違いOffice説明します。</span><span class="sxs-lookup"><span data-stu-id="b6513-110">This article describes the main differences between VBA macros (as well as VBA in general) and Office Scripts.</span></span> <span data-ttu-id="b6513-111">このOfficeスクリプトは、Excelでしか使用できないので、ここで説明する唯一のホストです。</span><span class="sxs-lookup"><span data-stu-id="b6513-111">Since Office Scripts are only available for Excel, that is the only host being discussed here.</span></span>

## <a name="platform-and-ecosystem"></a><span data-ttu-id="b6513-112">プラットフォームとエコシステム</span><span class="sxs-lookup"><span data-stu-id="b6513-112">Platform and ecosystem</span></span>

<span data-ttu-id="b6513-113">VBA はデスクトップ用に設計されOfficeスクリプトは Web 用に設計されています。</span><span class="sxs-lookup"><span data-stu-id="b6513-113">VBA is designed for the desktop and Office Scripts are designed for the web.</span></span> <span data-ttu-id="b6513-114">VBA は、ユーザーのデスクトップと対話して、COM や OLE などの同様のテクノロジと接続できます。</span><span class="sxs-lookup"><span data-stu-id="b6513-114">VBA can interact with a user's desktop to connect with similar technologies, such as COM and OLE.</span></span> <span data-ttu-id="b6513-115">ただし、VBA にはインターネットに呼び出す便利な方法はありません。</span><span class="sxs-lookup"><span data-stu-id="b6513-115">However, VBA has no convenient way to call out to the internet.</span></span>

<span data-ttu-id="b6513-116">Officeスクリプトは JavaScript の汎用ランタイムを使用します。</span><span class="sxs-lookup"><span data-stu-id="b6513-116">Office Scripts use a universal runtime for JavaScript.</span></span> <span data-ttu-id="b6513-117">これにより、スクリプトの実行に使用されるコンピューターに関係なく、一貫した動作とアクセシビリティが得されます。</span><span class="sxs-lookup"><span data-stu-id="b6513-117">This gives consistent behavior and accessibility, regardless of the machine being used to run the script.</span></span> <span data-ttu-id="b6513-118">また、他の Web サービスを呼び出す場合もあります。</span><span class="sxs-lookup"><span data-stu-id="b6513-118">They can also make calls to other web services.</span></span>

## <a name="security"></a><span data-ttu-id="b6513-119">セキュリティ</span><span class="sxs-lookup"><span data-stu-id="b6513-119">Security</span></span>

<span data-ttu-id="b6513-120">VBA マクロのセキュリティクリアランスは、VBA マクロと同Excel。</span><span class="sxs-lookup"><span data-stu-id="b6513-120">VBA macros have the same security clearance as Excel.</span></span> <span data-ttu-id="b6513-121">これにより、デスクトップにフル アクセスできます。</span><span class="sxs-lookup"><span data-stu-id="b6513-121">This gives them full access to your desktop.</span></span> <span data-ttu-id="b6513-122">Officeスクリプトはブックにのみアクセスできます。ブックをホストしているコンピューターにはアクセスできません。</span><span class="sxs-lookup"><span data-stu-id="b6513-122">Office Scripts only have access to the workbook, not the machine hosting the workbook.</span></span> <span data-ttu-id="b6513-123">さらに、スクリプトと JavaScript 認証トークンを共有できません。</span><span class="sxs-lookup"><span data-stu-id="b6513-123">Additionally, no JavaScript authentication tokens can be shared with scripts.</span></span> <span data-ttu-id="b6513-124">つまり、スクリプトにはサインインしているユーザーのトークンも、外部サービスにサインインする API 機能もないので、既存のトークンを使用してユーザーの代わりに外部呼び出しを行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="b6513-124">This means the script has neither the tokens of the signed-in user nor are there any API capabilities for signing in to an external service, so they are unable to use existing tokens to make external calls on behalf of the user.</span></span>

<span data-ttu-id="b6513-125">管理者には、VBA マクロの 3 つのオプションがあります。テナント上のすべてのマクロを許可する、テナントでマクロを許可する、または署名付き証明書を持つマクロのみを許可する。</span><span class="sxs-lookup"><span data-stu-id="b6513-125">Admins have three options for VBA macros: allow all macros on the tenant, allow no macros on the tenant, or allow only macros with signed certificates.</span></span> <span data-ttu-id="b6513-126">この粒度が不足すると、1 つの悪いアクターを分離するのは難しいです。</span><span class="sxs-lookup"><span data-stu-id="b6513-126">This lack of granularity makes it hard to isolate a single bad actor.</span></span> <span data-ttu-id="b6513-127">現在、Officeスクリプトはテナントのオンまたはオフのどちらかです。</span><span class="sxs-lookup"><span data-stu-id="b6513-127">Currently, Office Scripts are either on or off for a tenant.</span></span> <span data-ttu-id="b6513-128">ただし、管理者が個々のスクリプトとスクリプト作成者を詳細に制御する作業を行っています。</span><span class="sxs-lookup"><span data-stu-id="b6513-128">However, we are working to give admins more control over individual scripts and script creators.</span></span>

## <a name="coverage"></a><span data-ttu-id="b6513-129">割合</span><span class="sxs-lookup"><span data-stu-id="b6513-129">Coverage</span></span>

<span data-ttu-id="b6513-130">現在、VBA では、デスクトップ クライアントで使用できるExcel機能のより完全な範囲を提供しています。</span><span class="sxs-lookup"><span data-stu-id="b6513-130">Currently, VBA offers a more complete coverage of Excel features, particularly those available on the desktop client.</span></span> <span data-ttu-id="b6513-131">Officeスクリプトは、すべてのシナリオをサポートExcel on the web。</span><span class="sxs-lookup"><span data-stu-id="b6513-131">Office Scripts cover nearly all of the scenarios for Excel on the web.</span></span> <span data-ttu-id="b6513-132">さらに、Web で新機能が登場すると、Officeスクリプトはアクション レコーダー API と JavaScript API の両方でサポートされます。</span><span class="sxs-lookup"><span data-stu-id="b6513-132">Additionally, as new features debut on the web, Office Scripts will support them for both the Action Recorder and JavaScript APIs.</span></span>

<span data-ttu-id="b6513-133">Officeスクリプトは、レベルのイベントExcelサポート[されていません](/office/vba/excel/concepts/events-worksheetfunctions-shapes/using-events-with-excel-objects)。</span><span class="sxs-lookup"><span data-stu-id="b6513-133">Office Scripts don't support Excel-level [events](/office/vba/excel/concepts/events-worksheetfunctions-shapes/using-events-with-excel-objects).</span></span> <span data-ttu-id="b6513-134">スクリプトは、ユーザーが手動で起動した場合、またはスクリプトを呼び出Power Automate場合にのみ実行されます。</span><span class="sxs-lookup"><span data-stu-id="b6513-134">Scripts are only run when a user manually starts them or when a Power Automate flow calls the script.</span></span>

## <a name="power-automate"></a><span data-ttu-id="b6513-135">Power Automate</span><span class="sxs-lookup"><span data-stu-id="b6513-135">Power Automate</span></span>

<span data-ttu-id="b6513-136">Officeスクリプトは、次の方法でPower Automate。</span><span class="sxs-lookup"><span data-stu-id="b6513-136">Office Scripts can be run through Power Automate.</span></span> <span data-ttu-id="b6513-137">スケジュールされたフローまたはイベント駆動型フローを使用してブックを更新し、ワークフローを開かなくてもワークフローをExcel。</span><span class="sxs-lookup"><span data-stu-id="b6513-137">Your workbook can be updated through scheduled or event-driven flows, letting you automate workflows without even opening Excel.</span></span> <span data-ttu-id="b6513-138">つまり、ブックが OneDrive (および Power Automate からアクセス可能) に格納されている限り、組織が Excel のデスクトップ、Mac、または Web クライアントを使用するかどうかに関係なく、フローでスクリプトを実行できます。</span><span class="sxs-lookup"><span data-stu-id="b6513-138">This means that as long as your workbook is stored in OneDrive (and accessible to Power Automate), a flow can run your scripts regardless of whether you and your organization use Excel's desktop, Mac, or web client.</span></span>

<span data-ttu-id="b6513-139">VBA には、新しいコネクタPower Automateがあります。</span><span class="sxs-lookup"><span data-stu-id="b6513-139">VBA doesn't have a Power Automate connector.</span></span> <span data-ttu-id="b6513-140">サポートされている VBA シナリオはすべて、マクロの実行に参加するユーザーを含む。</span><span class="sxs-lookup"><span data-stu-id="b6513-140">All supported VBA scenarios involve a user attending to the macro's execution.</span></span>

<span data-ttu-id="b6513-141">手順の[詳細については、手動Power Automateから](../tutorials/excel-power-automate-manual.md)スクリプトを呼び出Power Automate。</span><span class="sxs-lookup"><span data-stu-id="b6513-141">Try the [Call scripts from a manual Power Automate flow](../tutorials/excel-power-automate-manual.md) tutorial to start learning about Power Automate.</span></span> <span data-ttu-id="b6513-142">また、[自動タスク[アラーム]](scenarios/task-reminders.md)サンプルを参照して、Officeシナリオで Teams Power Automateに接続されているスクリプトを確認することもできます。</span><span class="sxs-lookup"><span data-stu-id="b6513-142">You can also check out the [Automated task reminders](scenarios/task-reminders.md) sample to see Office Scripts connected to Teams through Power Automate in a real-world scenario.</span></span>

## <a name="see-also"></a><span data-ttu-id="b6513-143">関連項目</span><span class="sxs-lookup"><span data-stu-id="b6513-143">See also</span></span>

- [<span data-ttu-id="b6513-144">Excel on the web の Office スクリプト</span><span class="sxs-lookup"><span data-stu-id="b6513-144">Office Scripts in Excel on the web</span></span>](../overview/excel.md)
- [<span data-ttu-id="b6513-145">Power Automate を使用した Office スクリプトの実行</span><span class="sxs-lookup"><span data-stu-id="b6513-145">Run Office Scripts with Power Automate</span></span>](../develop/power-automate-integration.md)
- [<span data-ttu-id="b6513-146">Office スクリプトと Office アドインの違い</span><span class="sxs-lookup"><span data-stu-id="b6513-146">Differences between Office Scripts and Office Add-ins</span></span>](add-ins-differences.md)
- [<span data-ttu-id="b6513-147">Office スクリプトのトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="b6513-147">Troubleshooting Office Scripts</span></span>](../testing/troubleshooting.md)
- [<span data-ttu-id="b6513-148">Excel VBA リファレンス</span><span class="sxs-lookup"><span data-stu-id="b6513-148">Excel VBA reference</span></span>](/office/vba/api/overview/excel)
